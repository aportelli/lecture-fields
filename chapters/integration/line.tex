% !TEX root = ../../fields.tex
%% Brian Lecture 12 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Having completed our study of differential calculus of scalar and vector fields using
Cartesian coordinates, suffix notation and the Einstein summation convention, we now
embark on integral calculus of scalar and vector fields, which we will then apply to
physics.

We begin with some revision of the standard definition of the integral of a function of a
single variable. We then discuss line integrals, surface integrals and volume integrals.
Furthermore, we shall assume familiarity with integrals over plane areas (double
integrals) using Cartesian and plane polar coordinates, as covered in the specialist
mathematics course \emph{Several Variable Calculus and Differential Equations}, but we
will revise material when appropriate.

\subsection{Revision: defining integrals in \texorpdfstring{$\thickR$}{‚Ñù}}
\begin{figure}[t]
  \centering
  \includegraphics{tikz_riemann.pdf}
  \caption{Illustration of interval decomposition to define a Riemann sum.}
  \label{fig:riemann}
\end{figure}
We start with some formal definitions. Let $f(x)$ be a continuous real-valued function
defined on the interval $a \le x \le b$. Begin by subdividing this interval into $n$
subintervals:
\[
  a = x_0 < x_1 < x_2 \, \ldots \, < x_n = b \,.
\]
In interval $j$, pick an arbitrary point $x_j^*$ with $x_j \le x_j^* \le x_{j+1}$, as
illustrated in \cref{fig:riemann}. Define the Riemann sum
\[
  S_n = \sum_{j=0}^{n-1} f(x_j^*) \left(x_{j+1}-x_j\right)
\]
It can be shown that $S_n$ has a \emph{unique limit} as we let $n\to\infty$ and
$\left(x_{j+1}-x_j\right)\to0$ for all $j$, with
$\sum_{j=0}^{n-1}\left(x_{j+1}-x_j\right)=(b-a)$ kept fixed. In this limit
\[
  S_n \to \int_a^b f(x) \, \diff x % = \mbox{\emph{unique limit}}
\]
One can then prove the usual properties of integrals. Note that we also define
\[
  \int_b^a f(x) \, \diff x
  =
  - \int_a^b f(x) \, \diff x
\]

\subsection{Motivation and formal definition of line integrals}

\paragraph{Motivation:} As a physical example, consider a particle constrained to move along a wire under the
influence of a force $\v{F}(\v{r})$. Only the component of the force \emph{along} the
wire does work. Thus, the infinitesimal work $\diff W$ done by the force in moving the
particle along the wire from $\vr$ to $\vr + \diff \vr$ is
\[
  \diff W
  \,=\,
  \left(\left|\vF\right| \cos\theta\right) \, \left|\diff \vr\right|
  \,=\,
  \vF\cdot \diff \vr
\]
$\left|\vF\right| \cos\theta$ is the component of $\v{F}$ along $\diff \vr$, where
$\theta$ is the angle between $\v{F}(\v{r})$ and $\diff \v{r}$, as illustrated in
\cref{fig:line_int}. The \emph{total} work done in moving the particle along a wire which
follows some curve $C$ from point $P$ to point $Q$ is then intuitively
\[
  W_C= \int_{P}^{Q} \diff W = \int_C \vF(\vr)\cdot \diff  \v{r}
\]
This is a \emph{line} integral along the curve $C$. We now need to give a formal
definition to the integral above.

\paragraph{Formal definition:} Let $\v{a}(\vr)$ be a vector field defined in the region $R$, and let $C$ be a curve in
$R$ between two points $P$ and $Q$. Let $\v{r}$ be the position vector at some point on
the curve, and let $\dd\v{r}$ be an infinitesimal vector \emph{along} the curve at $\vr$.
The \emph{magnitude} of $\diff \v{r}$ is the infinitesimal \emph{arc length}: $\diff s =
  |\diff \v{r}|$. If $\v{t}$ is the \emph{unit vector} tangent to the curve at $\vr$
($\v{t}$ points in the direction of $\diff \v{r}$ at $\v{r}$), then
\[
  \dd \vr \,=\, \vt \: \dd s
  \qquad\mbox{or}\qquad
  \frac{\dd\vr}{\dd s} \,=\, \vt\,.
\]
The line integral is defined formally as a Riemann sum by dividing the curve into $n$
intervals
\[
  \intC\v{a}\cdot \diff \v{r}
  \,=\,
  \intC \, \v{a}\cdot\vt \; \diff s
  \,\equiv \,
  \lim_{\substack{\delta s_i\to 0 \\ n\to\infty}}\,
  %             \,=\, \lim_{\stackrel{n\to\infty}{\it\small ds\to 0}}\;
  \sum_{i=0}^{n-1}\;
  \delta s_i\,\v{a}(\v{r}_i)\cdot\vt_i
  \,,
\]
the $i^{\rm th}$ interval having length $\delta s_i$, unit tangent vector $\vt_i$,
\emph{etc}. It can be shown that the limit is unique for sufficiently smooth vector
fields $\v{a}(\v{r})$ and curve $C$.

In Cartesian coordinates, we have
\begin{equation}
  \intC\v{a}\cdot \diff \v{r}
  \,=\,
  \intC \left(a_1 \diff x_1 + a_2 \diff x_2 + a_3 \diff x_3 \right)
  \,=\,
  \intC a_{i} \, \diff x_i
  %  \intC \sum_{i=1}^{3} a_{i} \, \diff x_i
\end{equation}
where we used the summation convention in the last expression.
%
\begin{figure}[t]
  \centering
  \includegraphics{tikz_line_int.pdf}
  \caption{Movement of a particle on a wire under an external force field $\v{F}(\v{r})$.}
  \label{fig:line_int}
\end{figure}
%
In general, \emph{the line integral depends on the path joining $P$ and $Q$}. For
example, the $a_1$ component is $a_1(x_1 , x_2 , x_3)$ and all three coordinates will
generally change at once along the path. Therefore, one should \emph{not} compute $\int
  a_1 \,\diff x_1$ as an ordinary integral over $x_1$ holding $x_2$ and $x_3$ constant.
That would only be correct if $x_2$ and $x_3$ were \emph{constant} along the path,
\emph{i.e.} if the path were parallel to the $x_1$ axis. This is a common source of
mistakes.

\subsection{Parametric representation of line integrals}
The definition above was rather formal. What follows is more useful in practice. Often a
curve in three dimensions can be parameterised by a single real parameter, \eg if the
curve were the trajectory of a particle then a natural parameter would be the time $t$.
Sometimes the parameter of a line integral is chosen to be the arc-length $s$ along the
curve $C$.

If we parameterise the curve by a real parameter $\lambda$ (varying from $\lambda_P$ to
$\lambda_Q$) then we can write the three coordinates $x_i$ on the curve $C$ as functions
of $\lambda$:
\[
  x_i \,=\, x_i(\lambda), \quad \mbox{with\ } \lambda_P \le \lambda \le \lambda_Q
\]
so that
\begin{align*}
  \intC\v{a}\cdot \diff \v{r}
   & \,=\,
  \int_{\lambda_P}^{\lambda_Q}
  \left( \v{a} \,\cdot\, \frac{\diff \v{r}}{\diff \lambda} \right)\,
  \diff \lambda
  \,=\,
  \int_{\lambda_P}^{\lambda_Q}
  a_i\, \frac{\diff x_i}{\diff \lambda} \, \diff \lambda \\
   & \,=\,
  \int_{\lambda_P}^{\lambda_Q}
  \left( a_1\, \frac{\diff x_1}{\diff \lambda} +
  a_2\, \frac{\diff x_2}{\diff \lambda} +
  a_3\, \frac{\diff x_3}{\diff \lambda}
  \right) \diff \lambda
\end{align*}
If necessary, the curve $C$ may be subdivided into sections, each with a different
parameterisation (\emph{piecewise smooth curve}). It is very important to state, and we
will admit this here, that the integral above can be show to be independent of the
parameterisation of the curve $C$ as long as it goes through each point exactly once (\ie
there is a one-to-one or \emph{bijective} correspondence between the parameter values and
points on the curve).

\paragraph{Example:}
Let $\v{a}(\v{r}) = -ky\:\v{e}_{\,x} + kx \:\v{e}_{\,y}$, where $k$ is a positive
constant. Let us evaluate $\int_C \v{a}\cdot \diff \v{r}$ between the points with
Cartesian coordinates $(1,0,0)$ and $(0,1,0)$ along the curve $C$ defined by the
parameterisation $x=\cos\lambda$, $y=\sin\lambda$, and $z=0$ where $0 \le \lambda \le
  \pi/2$. One can notice that $C$ is one quarter of a unit circle. On the curve $C$, we
have
\begin{eqnarray*}
  \v{a}(\vr) & = & -ky \; \v{e}_{\,x} + kx \; \v{e}_{\,y}\, \,=\, -k\sin\lambda \;
  \v{e}_{\,x} + k\cos\lambda \; \v{e}_{\,y}  \\[0.75ex]
  %
  \vr
  & = & \cos\lambda\; \v{e}_{\,x} + \sin\lambda\; \v{e}_{\,y} \\[0.5ex]
  %
  \frac{\diff \v{r}}{\diff \lambda} & = & \left(-\sin\lambda\; \v{e}_{\,x} + \cos\lambda\;
  \v{e}_{\,y}\right)
\end{eqnarray*}
Therefore
\[
  \int_C \v{a}\cdot \diff \v{r}
  \,=\,
  \int_{0}^{\pi/2}
  \left( \v{a} \,\cdot\, \frac{\diff \v{r}}{\diff \lambda} \right)\,
  \diff \lambda
  \,=\,
  \int_{0}^{\pi/2} k \left(\sin^2\lambda+\cos^2\lambda\right)
  \diff \lambda
  \,=\,
  \int_{0}^{\pi/2} k \, \diff \lambda
  \,=\,
  \frac{k\pi}{2}
\]
Note: the field $\v{a}$ is parallel to $\frac{\diff \v{r}}{\diff \lambda}$ and hence to
$\diff \v{r}$, so the calculation is simple here.

\paragraph{Example:}
Let $\v{a}(\v{r})=(3x^2+6y)\:\v{e}_{\,x} - 14yz\:\v{e}_{\,y} + 20xz^2\:\v{e}_{\,z}$. Let
us evaluate $\int_C \v{a}\cdot \diff \v{r}$ between the points with Cartesian coordinates
$(0,0,0)$ and $(1,1,1)$, along the two paths $C$:
\begin{enumerate}
  \item $(0,0,0) \rightarrow (1,0,0) \rightarrow (1,1,0) \rightarrow (1,1,1)$

        (These are $3$ contiguous straight lines parallel to the $x$, $y$ \& $z$ axes
        respectively.)

  \item $x=\lambda$, $y=\lambda^2$, $z=\lambda^3\,,\,$ from $\lambda=0$ to $\lambda=1$.
\end{enumerate}
Let us evaluate $\int_C \v{a}\cdot \diff \v{r}$ on both paths in turn.
\begin{enumerate}
  \item
        \begin{enumerate}

          \item Along the line from $(0,0,0)$ to $(1,0,0)$, we have $y=z=0$, so $\diff y=\diff z=0,$
                hence $\diff \v{r} = \v{e}_{\,x}\,\diff x$ and $\v{a}=3x^2\,\v{e}_{\,x}$ (here the
                parameter is just $x$ itself), and
                \[
                  \int^{(1,0,0)}_{(0,0,0)} \v{a}\cdot \diff \v{r}
                  \,=\,  \int^{x=1}_{x=0}3x^2\,\diff x
                  \,=\,  \left[x^3\right]_0^1 \,=\, 1
                \]

          \item Along the line from $(1,0,0)$ to $(1,1,0)$, we have $x=1$, $\diff x=0$, $z=\diff z=0$, so
                $\diff \v{r} = \v{e}_{\,y}\,\diff y$ (here the parameter is $y$), and
                \begin{eqnarray*}
                  \v{a}
                  &=& \left(\left. 3x^2+6y\,\right)\right|_{x=1}\, \v{e}_{\,x} \,=\,
                  (3+6y)\,\v{e}_{\,x} \\[1ex]
                  %
                  \Rightarrow \quad \int^{(1,1,0)}_{(1,0,0)} \v{a}\cdot \diff \v{r} &=&
                  \int^{y=1}_{y=0}\left(3+6y\right) \; \v{e}_{\,x} \!\cdot \v{e}_{\,y} \;
                  \diff y \,=\, 0
                \end{eqnarray*}

          \item Along the line from $(1,1,0)$ to $(1,1,1)$, we have $x=y=1$, $\diff x=\diff y=0,$ and
                hence $\diff \v{r} = \v{e}_{\,z}\,\diff z$ and
                $\v{a}=9\,\v{e}_{\,x}-14z\,\v{e}_{\,y}+20z^2\, \v{e}_{\,z}$. Therefore
                \[
                  \int^{(1,1,1)}_{(1,1,0)} \v{a}\cdot \diff \v{r}
                  \,=\,
                  \int^{z=1}_{z=0} 20 z^2 \, \diff z
                  \,=\,
                  \left[\frac{20}{3} z^3 \right]_0^1
                  \,=\,
                  \frac{20}{3}
                \]

                Adding up the $3$ contributions, we get
                \[
                  \intC\v{a}\cdot \diff \v{r}
                  \,=\, 1 + 0 + \frac{20}{3}
                  \,=\,
                  \frac{23}{3}  \qquad \mbox{along path (i)}
                \]

        \end{enumerate}
        %\vspace*{-2ex}
  \item To integrate $\v{a}=(3x^2+6y)\,\v{e}_{\,x} - 14yz\v{e}_{\,y}\, + 20xz^2\v{e}_{\,z}$ along
        path~(ii), we parameterise
        \begin{eqnarray*}
          \vr
          & = & \lambda\,\v{e}_{\,x} + \lambda^2\,\v{e}_{\,y} + \lambda^3\, \v{e}_{\,z}
          \\[1ex]
          %
          \frac{\diff \vr}{\diff \lambda}
          &=& \v{e}_{\,x} + 2\lambda\, \v{e}_{\,y} + 3\lambda^2\, \v{e}_{\,z} \\[1ex]
          %
          \v{a}
          & = & \left(3\lambda^2+6\lambda^2\right)\, \v{e}_{\,x} -
          14\lambda^5\,\v{e}_{\,y} + 20\lambda^7\,\v{e}_{\,z} \quad\mbox{so that} \\[1ex]
          %\end{eqnarray*} \begin{eqnarray*}
          \intC \left(\v{a}\cdot\frac{\diff \vr}{\diff \lambda}\right)\, \diff \lambda &=&
          \int^{\lambda=1}_{\lambda=0} \left(9\lambda^2- 28\lambda^6+60\lambda^9\right)\,
          \diff \lambda \,=\, \big[3\lambda^3-4\lambda^7+6\lambda^{10}\big]^1_0 \,=\, 5
          \\[0.8ex]
          %
          \mbox{Hence}\qquad \intC\v{a}\cdot \diff \v{r} &=& 5  \qquad \mbox{along path
            (ii)}
        \end{eqnarray*}
\end{enumerate}
In this case, the integral of $\v{a}$ from $(0,0,0)$ to $(1,1,1)$ depends on the path
taken.
\begin{figure}[t]
  \centering
  \includegraphics{tikz_line_paths.pdf}
  \caption{Example of line integral over two different paths between two points.}
  \label{fig:line_paths}
\end{figure}

\paragraph{Notes:}
\begin{enumerate}
  \item The line integral $\int_C\v{a}\cdot \diff \v{r}$ is a \emph{scalar} quantity. Another
        \emph{scalar} line integral is $\int_C f\, \diff s$ where $f(\vr)$ is a scalar field and
        $\diff s $ is the infinitesimal arc-length introduced earlier. In fact, the length $\ell$
        of the curve $C$ is given by $\ell=\int_C\diff s$.
  \item A line integral around a \emph{simple} (doesn't intersect itself) \emph{closed} curve $C$
        is denoted by the symbol $\oint_C$
        \[
          \mbox{Example:}\quad \ointC \v{a}\cdot \diff \v{r}
          \,\equiv\, \mbox{the \emph{circulation} of $\v{a}$ around $C$}
        \]

\end{enumerate}

\paragraph{Example:}
Let $f(\vr) = ax^2 + by^2$. Evaluate $\oint_C f\,\diff s$ around the unit circle $C$
centred on the origin in the $(x,y)$ plane:
\[
  x=\cos\phi, \, y=\sin\phi, \, z=0; \quad 0\leq\phi\leq2\pi.
\]
\begin{eqnarray*}
  \mbox{On the curve $C$:} \hspace*{0.09\textwidth} f(\vr) & = & ax^2 + by^2 \,=\,
  a\cos^2\phi + b\sin^2\phi \hspace*{0.29\textwidth}\\[0.5ex]
  \vr
  & = & \cos\phi\, \v{e}_{\,x} + \sin\phi\, \v{e}_{\,y} \\[0.25ex]
  \diff \v{r} & = & \left(-\sin\phi\, \v{e}_{\,x} + \cos\phi\, \v{e}_{\,y}\right)\, \diff
  \phi\\
  \Rightarrow \quad \diff s & = & \sqrt{\diff \v{r}\cdot \diff \v{r}} \,=\,
  \left(\sin^2\phi+\cos^2\phi\right)^{1/2}\,\diff \phi \,=\, \diff \phi
\end{eqnarray*}
Therefore, in this example,
\[
  \ointC f\,\diff s
  \,=\,
  \int^{2\pi}_0 \left(a\cos^2\phi + b\sin^2\phi \right) \diff \phi
  \,=\, \pi\left(a+ b\right)
\]
We can additionally check that $\oint_C\diff s = \int^{2\pi}_0 \diff \phi = 2\pi$ is the
length of the circle.

\bigskip

One can also define \emph{vector} line integrals, \emph{e.g.}
\begin{enumerate}

  \item
        \(
        \intC \v{a}\; \diff s
        \,=\,
        \ei  \intC a_{i}\, \diff s
        \,=\,
        \intC
        \left(
        \eone \: a_1 \,+\, \etwo \: a_2 \,+\, \ethree \: a_3 \,
        \right)
        \diff s
        \)
        \ \ in Cartesian coordinates.

  \item
        \(
        \intC \v{a}\times \diff \v{r}
        \,=\,
        \ei \, \epsilon_{ijk} \,   \intC a_j \, \diff x_k
        \)
        \ \ in Cartesian coordinates, which is again a vector

        The parametric form is simply \( \intC \v{a}\times \diff \v{r} \,=\, \intC \left( \v{a}
        \times \frac{\diff \v{r}}{\diff \lambda} \right) \, \diff \lambda \)

  \item
        \(
        \intC f\, \diff \v{r}
        \,=\,
        \ei \intC f \; \diff x_i
        \,=\,
        \intC f \;
        \left(
        \eone   \, \diff x_1
        \,+\,
        \etwo   \, \diff x_2
        \,+\,
        \ethree \, \diff x_3
        \right)
        \)
        in Cartesian coordinates. In parametric form, this becomes
        \(
        \intC f\, \diff \v{r}
        \,=\,
        \intC f \: \frac{\diff \v{r}}{\diff \lambda} \;\, \diff \lambda
        \)

\end{enumerate}
Note that the result of performing the integral is a vector in each case.

\subsection{Current loop in a magnetic field}
\begin{figure}[t]
  \centering
  \includegraphics{tikz_loop-in-B-field.pdf}
  \caption{Illustration of a circular current loop in a radial magnetic field.}
  \label{fig:loop-in-B-field}
\end{figure}
Consider an electric current of magnitude $I$ flowing along a thin wire in the shape of a
closed path $C$. The magnetic force on an element $\diff \v{r}$ of the wire at $\v{r}$ due
to an external magnetic field $\v{B}(\v{r})$ is given by the Lorentz force
\[
  \diff \v{F}(\v{r})
  \,=\,
  I\, \diff \v{r} \times \v{B}(\v{r})\,.
\]
The \emph{total} force $\v{F}$ on the wire is the vector sum of the forces on the
individual elements, which is given by the line integral of $\diff \v{F}$ around the
closed curve $C$.
\[
  \v{F}
  \,=\,
  \ointC \diff \v{F}
  \,=\,
  \ointC I \, \diff \v{r} \times \v{B}(\v{r})
  ~=
  -I \ointC \v{B}(\v{r}) \times  \diff \v{r}
\]

\paragraph{Example:} For the (unrealistic!) case where the external magnetic field is $\vB(\vr) = B_0
  \big(x\,\v{e}_{\,x} + y\,\v{e}_{\,y}\big)$, let us evaluate the total force on a circular
current loop of radius $a$ which lies in the $(x,y)$ plane and is centred on the origin.
We parameterise the curve by the angle $\phi$ (as in plane polars), so that on the curve
$C$, we have
\begin{eqnarray*}
  \v{r}
  & = & a\cos\phi\,\v{e}_{\,x} + a\sin\phi\,\v{e}_{\,y} \\[1ex]
  %
  \diff \v{r} & = & \big(-a\sin\phi\, \v{e}_{\,x} + a\cos\phi\, \v{e}_{\,y}\big)\, \diff
  \phi\\[1ex]
  %
  \vB & = & B_0 \big( a\cos\phi\,\v{e}_{\,x} + a\sin\phi\,\v{e}_{\,y} \big) \\[1ex]
  %
  \Rightarrow\quad \ointC\vB\times \diff \v{r} &=& B_0 \, \int^{2\pi}_0
  \big(a^2\cos^2\phi + a^2\sin^2\phi \big)\, \v{e}_{\,z}\; \diff \phi \,=\, B_0 \,
  \v{e}_{\,z}\; a^2 \int^{2\pi}_0 \diff \phi \,=\, 2\pi a^2 B_0 \, \v{e}_{\,z} \\[1ex]
  \mbox{So} \quad
  \v{F}
  & = & -2\pi a^2 B_0 I \, \v{e}_{\,z} \quad \mbox{which is in a vertically downward
    direction.}
\end{eqnarray*}
